#!/usr/bin/env Rscript
## -*- mode: R -*-

## This program is free software: you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with this program.  If not, see <http://www.gnu.org/licenses/>.

## sample usage
## Rscript eval_ts.Rscript sample 323232 "1,2,32,32,32,33,32,32,32,32,32,3,6,7,8,8,99,9,90" 2001-1  2
## Rscript eval_ts.Rscript sample 323232 "1,2,32,32,32,33,32,32,32,32,32,3,6,7,8,8,99,9,90" 2001-1  2 "n.ahead=3"
## Rscript eval_ts.Rscript sample 323232 "1,2,32,32,32,33,32,32,32,32,32,3,6,7,8,8,99,9,90" 2001-1  2 "" "2001-1 ...."

library(methods)
source("engine.R")

args <- commandArgs()

project.name <- args[6]
id <- as.integer(args[7])
ts.string <- args[8]
period.start.string <- args[9]
period.freq <- as.integer(args[10])
item.params <- args[11]
ts.periods.string <-args[12]

if (is.na(ts.periods.string))
  ts.periods.string <- NULL

CONFIG <- GetProjectConfig(project.name)

source(CONFIG$eval.package)
param <- EvalParamString(item.params)

msg <- paste("Project=", project.name, ", TS=", ts.string, sep="")
print(msg)
msg <- paste("item.params=", item.params, sep="")
print(msg)
msg <- paste("period.start=", period.start.string, sep="")
print(msg)
msg <- paste("id=", id, sep=" ")
print(msg)
msg <- paste("period.freq=", period.freq, sep="")
print(msg)

EvalTSString(project.name=project.name, id=id, ts.string=ts.string,
             ts.periods.string=ts.periods.string,
             ##ts.periods.string = NULL,
             period.start.string=period.start.string,
             period.freq=period.freq, param=param, CONFIG=CONFIG
             )
